{
	"name": "5_create_bronze_views",
	"properties": {
		"folder": {
			"name": "ldw"
		},
		"content": {
			"query": "use oxemarine_ldw\nGO\n\nDROP VIEW IF EXISTS bronze.vw_device\nGO\nCREATE VIEW bronze.vw_device\nAS\n    SELECT\n    dev.filepath(1) as device,\n    dev.filepath(2) as year,\n    dev.filepath(3) as month,\n    dev.filepath(4) as day,\n    dev.[timestamp]\n--ActualPressure\n      ,dev.[PressureSource]\n      ,dev.[AtmosphericPressure]\n      ,dev.[FuelRailPressure]\n--ActuatorCommand\n      ,dev.[GearCommand]      \n      ,dev.[ThrottleCommand]  \n--CogSogRapidUpdate      \n      ,dev.[CourseOverGround]   \n      ,dev.[CourseOverGround_deg] \n      ,dev.[SpeedOverGround]    \n      ,dev.[SpeedOverGround_kn]\n--EngineParametersDynamic      \n      ,dev.[EngineOilPressure0]  \n      ,dev.[EngineOilTemp]     \n      ,dev.[EngineCoolantTemp] \n      ,dev.[BatteryVoltage]    \n      ,dev.[FuelRate]          \n      ,dev.[TotalEngineHours]   \n      ,dev.[EngineLoad]         \n      ,dev.[EngineOilPressure1]  \n      ,dev.[EngineOilPressure2]  \n      ,dev.[EngineOilPressure3] \n--EngineParametersRapid\n      ,dev.[EngineSpeed]\n      ,dev.[BoostPressure]\n      ,dev.[PttTrim]\n--OxeProprietary1 \n      ,dev.[ActualClutchSlip]\n      ,dev.[ControlheadPosition]\n      ,dev.[PropellerSpeed]\n      ,dev.[RequestClutchSlip]\n--OxeProprietary4\n      ,dev.[GpcState]\n      ,dev.[GpcDuty]\n      ,dev.[GpcModuleFaults]\n--PcmFeedback\n      ,dev.[PortCylinderPosition]\n      ,dev.[StbdCylinderPosition]\n--PositionRapidUpdate\n      ,dev.[Latitude] \n      ,dev.[Longitude]\n--ProductInformation     \n      ,dev.[EngineModel]       \n      ,dev.[EngineSwVersion]    \n      ,dev.[EngineFwVersion]   \n      ,dev.[EngineSerialnumber] \n--TemperatureExtendedRange\n      ,dev.[TemperatureSource]\n      ,dev.[EngineRoomTemp]\n      ,dev.[ExhaustGasTemp]\n      ,dev.[IntakeManifoldTemp]\n      ,dev.[FuelTemp]\n      ,dev.[EcuTemp]\n      ,dev.[CompressorOutTemp]\n--TransmissionParametersDynamic\n      ,dev.[GearboxOilPressure]\n      ,dev.[GearboxGear]\n      ,dev.[GearboxOilTemp]\n--TripParametersEngine    \n      ,dev.[FuelUsed]          \n      ,dev.[FuelRateAverage]    \n         \n \nFROM\n    OPENROWSET(\n        BULK '/textdata/DEVICE/Device=*/year=*/month=*/day=*/*.csv',\n        DATA_SOURCE = 'oxemarine_src',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamp datetime2(0) 1,\n--ActualPressure        \n        PressureSource float 2,\n        AtmosphericPressure FLOAT 3,\n        FuelRailPressure FLOAT 4,\n--ActuatorCommand\n      GearCommand  float 5, \n      ThrottleCommand float 6, \n--CogSogRapidUpdate      \n      CourseOverGround  float 7,\n      CourseOverGround_deg float 8,   \n      SpeedOverGround float 9,\n      SpeedOverGround_kn float 10,\n--EngineParametersDynamic      \n      EngineOilPressure0 float 11,\n      EngineOilTemp float 12,\n      EngineCoolantTemp float 13,\n      BatteryVoltage float 14,\n      FuelRate float 15,\n      TotalEngineHours FLOAT 16,\n      EngineLoad FLOAT 17,  \n      EngineOilPressure1 float 18,\n      EngineOilPressure2 float 19,\n      EngineOilPressure3 float 20,\n   \n--EngineParametersRapid\n      EngineSpeed float 21,\n      BoostPressure float 22,\n      PttTrim float 23,\n--OxeProprietary1 \n      ActualClutchSlip float 24,\n      ControlheadPosition float 25,\n      PropellerSpeed float 26,\n      RequestClutchSlip float 27,\n--OxeProprietary4\n      GpcState float 28,\n      GpcDuty float 29,\n      GpcModuleFaults float 30,\n--PcmFeedback\n      PortCylinderPosition float 31,   \n      StbdCylinderPosition float 32, \n--PositionRapidUpdate\n      Latitude float 33,\n      Longitude float 34,\n--ProductInformation     \n      EngineModel varchar(100)   35,\n      EngineSwVersion varchar(100)   36,\n      EngineFwVersion varchar(100)   37,\n      EngineSerialnumber varchar(100)   38,\n--TemperatureExtendedRange\n      TemperatureSource float 39,\n      EngineRoomTemp FLOAT 40,\n      ExhaustGasTemp FLOAT 41,\n\tIntakeManifoldTemp FLOAT 42,\n      FuelTemp FLOAT 43,\n\tEcuTemp FLOAT 44,\n      CompressorOutTemp FLOAT 45,\n--TransmissionParametersDynamic\n      GearboxOilPressure float 46,\n      GearboxGear float 47,\n      GearboxOilTemp float 48,\n--TripParametersEngine    \n      FuelUsed float 49,\n      FuelRateAverage float 50\n\n    ) AS [dev]\nGO\n\nselect * from bronze.vw_device\nwhere device='D994BF29' and year=2023 and month=02 and day=16\n  ",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "oxemarine_ldw",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}