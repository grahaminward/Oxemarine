{
	"name": "1_explore_device",
	"properties": {
		"folder": {
			"name": "Discovery"
		},
		"content": {
			"query": "use oxemarine_ldw\nGO\n\n\nExec sp_describe_first_result_set N'\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK ''abfss://fs-oxe-bronze@stoxemarine.dfs.core.windows.net/outputcsv/50B8FE41-20221107-6368FA59.csv'',\n        FORMAT = ''CSV'',\n        PARSER_VERSION = ''2.0'',\n        HEADER_ROW = TRUE\n    ) AS [result] '\n\nSELECT\n    max(len([CAN1.OxeProprietary4.GpcState]))             as len_GpcState,\n    max(len([CAN1.OxeProprietary4.GpcDuty]))              as len_GpcDuty,\n    max(len([CAN1.OxeProprietary4.GpcModuleFaults]))      as len_GpcModuleFaults,\n    \n    max(len([CAN1.OxeProprietary1.ActualClutchSlip]))       as len_ActualClutchSlip,\n    max(len([CAN1.OxeProprietary1.ControlheadPosition]))    as len_ControlheadPosition,\n    max(len([CAN1.OxeProprietary1.PropellerSpeed]))         as len_PropellerSpeed,\n    max(len([CAN1.OxeProprietary1.RequestClutchSlip]))      as len_RequestClutchSlip,\n\n    max(len([CAN1.TemperatureExtendedRange.TemperatueSource]))      as len_TemperatueSource,\n    max(len([CAN1.TemperatureExtendedRange.EngineRoomTemp]))        as len_EngineRoomTemp,\n    max(len([CAN1.TemperatureExtendedRange.ExhaustGasTemp]))        as len_ExhaustGasTemp,\n    max(len([CAN1.TemperatureExtendedRange.IntakeManifoldTemp]))    as len_IntakeManifoldTemp,\n    max(len([CAN1.TemperatureExtendedRange.FuelTemp]))              as len_FuelTemp,\n    max(len([CAN1.TemperatureExtendedRange.EcuTemp]))               as len_EcuTemp,\n    max(len([CAN1.TemperatureExtendedRange.CompressorOutTemp]))     as len_CompressorOutTemp,\n\n    max(len([CAN1.ActualPressure.PressureSource]))                  as len_PressureSource,\n    max(len([CAN1.ActualPressure.AtmosphericPressure]))             as len_AtmosphericPressure,\n    max(len([CAN1.ActualPressure._GearboxOilPressure]))             as len__GearboxOilPressure,\n    max(len([CAN1.ActualPressure._EngineOilPressure]))              as len__EngineOilPressure,\n    max(len([CAN1.ActualPressure.FuelRailPressure]))                as len_FuelRailPressure,\n    \n    --max(len([CAN1.TripParametersEngine.FuelUsed]))                  as len_FuelUsed,\n    --max(len([CAN1.TripParametersEngine.FuelRateAverage]))           as len_FuelRateAverage,\n    --max(len([CAN1.TripParametersEngine._FuelRate]))                 as len__FuelRate,\n\n    max(len([CAN1.TransmissionParametersDynamic.GearboxOilPressure])) as len_GearboxOilPressure,\n    max(len([CAN1.TransmissionParametersDynamic.GearboxGear]))      as len_GearboxGear,\n    max(len([CAN1.TransmissionParametersDynamic.GearboxOilTemp]))   as len_GearboxOilTemp,\n\n    max(len([CAN1.EngineParametersDynamic.EngineOilPressure]))      as len_EngineOilPressure,\n    max(len([CAN1.EngineParametersDynamic.EngineOilTemp]))          as len_EngineOilTemp,\n    max(len([CAN1.EngineParametersDynamic.EngineCoolantTemp]))      as len_EngineCoolantTemp,\n    max(len([CAN1.EngineParametersDynamic.BatteryVoltage]))         as len_BatteryVoltage,\n    max(len([CAN1.EngineParametersDynamic.FuelRate]))               as len_FuelRate,\n    max(len([CAN1.EngineParametersDynamic.TotalEngineHours]))       as len_TotalEngineHours,\n    max(len([CAN1.EngineParametersDynamic.EngineLoad]))             as len_EngineLoad,\n\n    max(len([CAN1.EngineParametersRapid.EngineSpeed]))              as len_EngineSpeed,\n    max(len([CAN1.EngineParametersRapid.BoostPressure]))            as len_BoostPressure,\n    max(len([CAN1.EngineParametersRapid.PttTrim]))                  as len_PttTrim,\n    \n    max(len([CAN1.ProductInformation.EngineModel]))                 as len_EngineModel,\n    max(len([CAN1.ProductInformation.EngineSwVersion]))             as len_EngineSwVersion,\n    max(len([CAN1.ProductInformation.EngineFwVersion]))             as len_EngineFwVersion,\n    max(len([CAN1.ProductInformation.EngineSerialnumber]))          as len_EngineSerialnumber,\n    \n    max(len([CAN1._PositionRapidUpdate._Latitude]))                 as len__Latitude,\n    max(len([CAN1._PositionRapidUpdate._Longitude]))                as len__Longitude,\n\n    max(len([CAN1.ActuatorCommand.GearCommand]))                    as len_GearCommand,\n    max(len([CAN1.ActuatorCommand.ThrottleCommand]))                as len_ThrottleCommand,\n    \n    max(len([CAN1._CogSogRapidUpdate._SpeedOverGround]))            as len__SpeedOverGround,\n\n    max(len([CAN1.PositionRapidUpdate.Latitude]))                   as len_Latitude,\n    max(len([CAN1.PositionRapidUpdate.Longitude]))                  as len_Longitude,\n\n    max(len([CAN1.CogSogRapidUpdate.CourseOverGround]))             as len_CourseOverGround,\n    max(len([CAN1.CogSogRapidUpdate.CourseOverGround_deg]))         as len_CourseOverGround_deg,\n    max(len([CAN1.CogSogRapidUpdate.SpeedOverGround]))              as len_SpeedOverGround,\n    max(len([CAN1.CogSogRapidUpdate.SpeedOverGround_kn]))           as len_SpeedOverGround_kn,\n\n    max(len([CAN1.PcmFeedback.PortCylinderPosition]))               as len_PortCylinderPosition,\n    max(len([CAN1.PcmFeedback.StbdCylinderPosition]))               as len_StbdCylinderPosition\n\nFROM    OPENROWSET(\n        BULK 'https://stoxemarine.dfs.core.windows.net/fs-oxe-bronze/outputcsv/50B8FE41-20221104-636515D3.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS [result]\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://stoxemarine.dfs.core.windows.net/fs-oxe-bronze/outputcsv/50B8FE41-20221104-636515D3.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamps datetime2(0),\n        [CAN1.OxeProprietary1.ActualClutchSlip] SMALLINT,\n        [CAN1.OxeProprietary1.ControlheadPosition] SMALLINT,\n        [CAN1.OxeProprietary1.PropellerSpeed] FLOAT,\n        [CAN1.OxeProprietary1.RequestClutchSlip] SMALLINT,\n\n        [CAN1.OxeProprietary4.GpcState] SMALLINT,\n        [CAN1.OxeProprietary4.GpcDuty] FLOAT,\n        [CAN1.OxeProprietary4.GpcModuleFaults] SMALLINT,\n\n        [CAN1.EngineParametersRapid.EngineSpeed] FLOAT,\n        [CAN1.EngineParametersRapid.BoostPressure] FLOAT,\n        [CAN1.EngineParametersRapid.PttTrim] SMALLINT,\n        \n        [CAN1.TransmissionParametersDynamic.GearboxOilPressure] FLOAT,\n        [CAN1.TransmissionParametersDynamic.GearboxGear] SMALLINT,\n        [CAN1.TransmissionParametersDynamic.GearboxOilTemp] FLOAT,\n        \n        [CAN1.ActualPressure.PressureSource] SMALLINT,\n        [CAN1.ActualPressure.AtmosphericPressure] FLOAT,\n        [CAN1.ActualPressure._GearboxOilPressure] FLOAT,\n        [CAN1.ActualPressure._EngineOilPressure] FLOAT,\n\t    [CAN1.ActualPressure.FuelRailPressure] FLOAT,\n        \n\t   \n        [CAN1.TemperatureExtendedRange.TemperatueSource] SMALLINT,\n        [CAN1.TemperatureExtendedRange.EngineRoomTemp] FLOAT,\n        [CAN1.TemperatureExtendedRange.ExhaustGasTemp] FLOAT,\n\t    [CAN1.TemperatureExtendedRange.IntakeManifoldTemp] FLOAT,\n        [CAN1.TemperatureExtendedRange.FuelTemp] FLOAT,\n\t    [CAN1.TemperatureExtendedRange.EcuTemp] FLOAT,\n\n        [CAN1.TemperatureExtendedRange.CompressorOutTemp] FLOAT\n    \n    ) AS [result]\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://stoxemarine.dfs.core.windows.net/fs-oxe-bronze/outputcsv/50B8FE41-20221104-636515D3.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamp datetime2(0) 1,\n        ActualClutchSlip SMALLINT 2,\n        ControlheadPosition SMALLINT 3,\n        PropellerSpeed FLOAT 4,\n        RequestClutchSlip SMALLINT 5,\n        EngineSpeed FLOAT 6,\n        BoostPressure FLOAT 7,\n        PttTrim SMALLINT 8,\n        GearboxOilPressure FLOAT 9,\n        GearboxGear SMALLINT 10,\n        PressureSource SMALLINT 11,\n        AtmosphericPressure FLOAT 12,\n        _GearboxOilPressure FLOAT 13,\n\t    _EngineOilPressure FLOAT 14,\n\t    FuelRailPressure FLOAT 15,\n\t    TemperatueSource SMALLINT 16,\n\t    IntakeManifoldTemp FLOAT 17,\n\t    EcuTemp FLOAT 18\n    \n    ) AS [result]\n\n --create external data source\n CREATE EXTERNAL  DATA SOURCE oxemarine  \nWITH (\n    LOCATION = 'abfss://oxemarine@stsynapsetaxi.dfs.core.windows.net'\n)\n\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK '/outputcsv/50B8FE41-20221104-636515D3.csv',\n        DATA_SOURCE = 'oxemarine',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamp datetime2(0) 1,\n        ActualClutchSlip SMALLINT 2,\n        ControlheadPosition SMALLINT 3,\n        PropellerSpeed FLOAT 4,\n        RequestClutchSlip SMALLINT 5,\n        EngineSpeed FLOAT 6,\n        BoostPressure FLOAT 7,\n        PttTrim SMALLINT 8,\n        GearboxOilPressure FLOAT 9,\n        GearboxGear SMALLINT 10,\n        PressureSource SMALLINT 11,\n        AtmosphericPressure FLOAT 12,\n        _GearboxOilPressure FLOAT 13,\n\t    _EngineOilPressure FLOAT 14,\n\t    FuelRailPressure FLOAT 15,\n\t    TemperatueSource SMALLINT 16,\n\t    IntakeManifoldTemp FLOAT 17,\n\t    EcuTemp FLOAT 18\n    \n    ) AS [result]\n\nSELECT name, location from sys.external_data_sources\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK '/outputcsv/',\n        DATA_SOURCE = 'oxemarine',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamp datetime2(0) 1,\n        ActualClutchSlip SMALLINT 2,\n        ControlheadPosition SMALLINT 3,\n        PropellerSpeed FLOAT 4,\n        RequestClutchSlip SMALLINT 5,\n\n        GpcState SMALLINT 6,\n        GpcDuty FLOAT 7,\n        GpcModuleFaults SMALLINT 8,\n\n        EngineSpeed FLOAT 9,\n        BoostPressure FLOAT 10,\n        PttTrim SMALLINT 11,\n        \n        GearboxOilPressure FLOAT 12,\n        GearboxGear SMALLINT 13,\n        GearboxOilTemp FLOAT 14,\n        \n        PressureSource SMALLINT 15,\n        AtmosphericPressure FLOAT 16,\n        _GearboxOilPressure FLOAT 17,\n        _EngineOilPressure FLOAT 18,\n\t    FuelRailPressure FLOAT 19,\n        \t   \n        TemperatueSource SMALLINT 20,\n        EngineRoomTemp FLOAT 21,\n        ExhaustGasTemp FLOAT 22,\n\t    IntakeManifoldTemp FLOAT 23,\n        FuelTemp FLOAT 24,\n\t    EcuTemp FLOAT 25,\n\n        CompressorOutTemp FLOAT 26\n    \n    ) AS [result]\n\nSELECT\n    dev.filename() as filename,\n    count(1) as recordCount\nFROM\n    OPENROWSET(\n        BULK '/textdata/DEVICE/DEVICE=*/year=*/month=*/day=*/*.csv',\n        DATA_SOURCE = 'oxemarine',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamp datetime2(0) 1,\n        ActualClutchSlip SMALLINT 2,\n        ControlheadPosition SMALLINT 3,\n        PropellerSpeed FLOAT 4,\n        RequestClutchSlip SMALLINT 5,\n\n        GpcState SMALLINT 6,\n        GpcDuty FLOAT 7,\n        GpcModuleFaults SMALLINT 8,\n\n        EngineSpeed FLOAT 9,\n        BoostPressure FLOAT 10,\n        PttTrim SMALLINT 11,\n        \n        GearboxOilPressure FLOAT 12,\n        GearboxGear SMALLINT 13,\n        GearboxOilTemp FLOAT 14,\n        \n        PressureSource SMALLINT 15,\n        AtmosphericPressure FLOAT 16,\n        _GearboxOilPressure FLOAT 17,\n        _EngineOilPressure FLOAT 18,\n\t    FuelRailPressure FLOAT 19,\n        \t   \n        TemperatueSource SMALLINT 20,\n        EngineRoomTemp FLOAT 21,\n        ExhaustGasTemp FLOAT 22,\n\t    IntakeManifoldTemp FLOAT 23,\n        FuelTemp FLOAT 24,\n\t    EcuTemp FLOAT 25,\n\n        CompressorOutTemp FLOAT 26\n    \n    ) AS [dev]\n    group by dev.filename()\n    order by dev.filename()\n\n\n    SELECT\n    dev.filepath(1) as device,\n    dev.filepath(2) as year,\n    dev.filepath(3) as month,\n    dev.filepath(4) as day,\n    count(1) as recordCount\nFROM\n    OPENROWSET(\n        BULK '/textdata/DEVICE/DEVICE=*/year=*/month=*/day=*/*.csv',\n        DATA_SOURCE = 'oxemarine_src',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    )\n    WITH (\n        timestamp datetime2(0) 1,\n        ActualClutchSlip SMALLINT 2,\n        ControlheadPosition SMALLINT 3,\n        PropellerSpeed FLOAT 4,\n        RequestClutchSlip SMALLINT 5,\n        EngineSpeed FLOAT 6,\n        BoostPressure FLOAT 7,\n        PttTrim SMALLINT 8,\n        GearboxOilPressure FLOAT 9,\n        GearboxGear SMALLINT 10,\n        PressureSource SMALLINT 11,\n        AtmosphericPressure FLOAT 12,\n        _GearboxOilPressure FLOAT 13,\n\t    _EngineOilPressure FLOAT 14,\n\t    FuelRailPressure FLOAT 15,\n\t    TemperatueSource SMALLINT 16,\n\t    IntakeManifoldTemp FLOAT 17,\n\t    EcuTemp FLOAT 18\n    \n    ) AS [dev]\n    group by dev.filepath(1) ,dev.filepath(2), dev.filepath(3), dev.filepath(4) \n    order by dev.filepath(1) ,dev.filepath(2), dev.filepath(3), dev.filepath(4) \n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}